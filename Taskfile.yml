# code generated by retab. DO NOT EDIT.
# join the fight against yaml @ github.com/walteh/retab

# source: ".retab/task.retab"

version: 3
tasks:
    mockery-bin:
        cmds:
            - |
              GOWORK=off go build -mod=vendor -o ./bin/mockery github.com/vektra/mockery/v2
        dir: tools
        generates:
            - bin/mockery
        sources:
            - '**/*'
            - exclude: bin/**/*
    gotestsum-bin:
        generates:
            - bin/gotestsum
        dir: tools
        sources:
            - '**/*'
            - exclude: bin/**/*
        cmds:
            - GOWORK=off go build -mod=vendor -o ./bin/gotestsum gotest.tools/gotestsum
    golangci-lint-bin:
        generates:
            - bin/golangci-lint
        dir: tools
        sources:
            - '**/*'
            - exclude: bin/**/*
            - tools
        cmds:
            - R09XT1JLPW9mZiBnbyBidWlsZCAtbW9kPXZlbmRvciAtbyAuL2Jpbi9nb2xhbmdjaS1saW50IGdpdGh1Yi5jb20vZ29sYW5nY2kvZ29sYW5nY2ktbGludC9jbWQvZ29sYW5nY2ktbGludA==
    mockery-gen:
        deps:
            - mockery-bin
        generates:
            - gen/mockery/**/*
        dir: .
        sources:
            - '**/*.go'
            - ./.mockery.yaml
            - ./tools/bin/mockery
        cmds:
            - ./tools/bin/mockery --dir ./gen/mockery --config ./.mockery.yaml
    lint:
        deps:
            - golangci-lint-bin
        sources:
            - '**/*.go'
            - exclude: tools/**/*
            - ./tools/bin/golangci-lint
        cmds:
            - GOWORK=off ./tools/bin/golangci-lint run --config ./.golangci.yml
    test-ci:
        deps:
            - gotestsum-bin
        sources:
            - '**/*.go'
            - exclude: tools/**/*
            - ./tools/bin/gotestsum
        preconditions:
            - which go
        cmds:
            - GOWORK=off ./tools/bin/gotestsum --junitfile test-reports/junit.xml -- -v -coverprofile=coverage.out -coverpkg=./... ./...
    default:
        deps:
            - tools
            - gen
            - lint
            - test
